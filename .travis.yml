# Travis CI Configuration file
# @link https://travis-ci.org/

# PHP as the project language
language: php
php:
  - '5.4'
  - '5.5'
  - '5.6'
  - '7.0'
env:
  # WordPress 4.3
  - WP_VERSION=4.3
  # WordPress 4.0
  - WP_VERSION=4.2
  # WordPress 4.1
  - WP_VERSION=4.1
  # WordPress 4.0
  - WP_VERSION=4.0
  # WordPress 3.9
  - WP_VERSION=3.9

before_install:
  # set up WP install
  - export WP_DEVELOP_DIR=/tmp/wordpress/
  - mkdir -p $WP_DEVELOP_DIR
  - git clone --depth=1 --branch="$WP_VERSION" git://develop.git.wordpress.org/ $WP_DEVELOP_DIR
  - plugin_slug=$(basename $(pwd))
  - plugin_dir=$WP_DEVELOP_DIR/src/wp-content/plugins/$plugin_slug
  - cd ..
  - mv $plugin_slug $plugin_dir
  # set up tests config
  - cd $WP_DEVELOP_DIR
  - echo $WP_DEVELOP_DIR
  - cp wp-tests-config-sample.php wp-tests-config.php
  - sed -i "s/youremptytestdbnamehere/wordpress_test/" wp-tests-config.php
  - sed -i "s/yourusernamehere/travis/" wp-tests-config.php
  - sed -i "s/yourpasswordhere//" wp-tests-config.php
  # create database
  - mysql -e 'CREATE DATABASE wordpress_test;' -uroot
  # prepare for running the tests
  - cd $plugin_dir

# script: phpunit